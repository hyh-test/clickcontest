# ν΄λ¦­ μ½ν…μ¤νΈ μ„λ²„

**π’΅ μ°Έκ³ :** μ΄ ν”„λ΅μ νΈμ μ‹¤ν–‰ λ° ν…μ¤νΈ λ°©λ²•μ€ μ£Όλ΅ **Windows ν™κ²½**μ— λ§μ¶°μ Έ μμµλ‹λ‹¤.

μ΄ ν”„λ΅μ νΈλ” Node.js λ‚΄μ¥ λ¨λ“λ§μ„ μ‚¬μ©ν•μ—¬ μ μ‘λ κ°„λ‹¨ν• ν΄λ¦­ μ½ν…μ¤νΈ κ²μ„μ λ°±μ—”λ“ μ„λ²„μ…λ‹λ‹¤.

## μ£Όμ” κΈ°μ 

- **μ„λ²„:** `node:http` (Node.js λ‚΄μ¥ HTTP λ¨λ“)
- **λ°μ΄ν„°λ² μ΄μ¤:** `node:sqlite` (Node.js v22+ λ‚΄μ¥ SQLite λ¨λ“)
- **μμ΅΄μ„±:** μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬(`npm` ν¨ν‚¤μ§€ λ“±)λ¥Ό μ „ν€ μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤.

---

## μ‹¤ν–‰ λ°©λ²•

μ΄ ν”„λ΅μ νΈλ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄ **Node.js v22.0.0 μ΄μƒ** λ²„μ „μ΄ λ°λ“μ‹ ν•„μ”ν•©λ‹λ‹¤.

1.  **ν”„λ΅μ νΈ ν΄λ΅  λλ” λ‹¤μ΄λ΅λ“**

2.  **ν„°λ―Έλ„μ—μ„ λ©”μΈ μ„λ²„ μ‹¤ν–‰**
    ν”„λ΅μ νΈμ λ£¨νΈ λ””λ ‰ν† λ¦¬μ—μ„ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ—¬ μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

    ```bash
    node --experimental-sqlite server.js
    ```

    -   `--experimental-sqlite` ν”λκ·Έλ” λ‚΄μ¥ SQLite λ¨λ“μ„ ν™μ„±ν™”ν•κΈ° μ„ν•΄ ν•„μμ μ…λ‹λ‹¤.
    -   μ΄ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•λ©΄ HTTP μ„λ²„(ν¬νΈ 3000)μ™€ TCP μ„λ²„(ν¬νΈ 3001)κ°€ λ™μ‹μ— μ‹μ‘λ©λ‹λ‹¤.

3.  **μ„λ²„ μ‹¤ν–‰ ν™•μΈ**
    μ„λ²„κ°€ μ„±κ³µμ μΌλ΅ μ‹¤ν–‰λλ©΄ ν„°λ―Έλ„μ— λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€κ°€ μ¶λ ¥λ©λ‹λ‹¤.

    ```
    μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘ μ¤‘...
    λ°μ΄ν„°λ² μ΄μ¤κ°€ μ„±κ³µμ μΌλ΅ μ΄κΈ°ν™”λμ—μµλ‹λ‹¤. (C:\...\clickcontest\clickgame.db)
    κ²μ„μ΄ μ‹μ‘λμ—μµλ‹λ‹¤.
    HTTP μ„λ²„ μ‹¤ν–‰ μ¤‘: http://localhost:3000
    TCP ν΄λ¦­ μ„λ²„ μ‹¤ν–‰ μ¤‘: ν¬νΈ 3001
    λ¨λ“  μ„λ²„κ°€ μ„±κ³µμ μΌλ΅ μ‹μ‘λμ—μµλ‹λ‹¤.
    ```

---

## API λ° μ¤ν¬λ¦½νΈ ν…μ¤νΈ λ°©λ²•

μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈ μƒνƒμ—μ„, **μƒλ΅μ΄ ν„°λ―Έλ„**μ„ μ—΄κ³  μ•„λ λ°©λ²•μ„ μ‚¬μ©ν•μ—¬ κΈ°λ¥μ„ ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

### 1. νμ›κ°€μ… (`/signup` API)

μ‚¬μ©μλ¥Ό λ°μ΄ν„°λ² μ΄μ¤μ— λ“±λ΅ν•©λ‹λ‹¤.

-   **URL:** `/signup`
-   **Method:** `POST`
-   **Body:**
    ```json
    {
      "userId": "string",
      "address": "string"
    }
    ```

#### ν…μ¤νΈ λ…λ Ήμ–΄ μμ‹ (Windows PowerShell)

PowerShellμ—μ„λ” `curl` λ³„μΉ­ λ€μ‹  `Invoke-WebRequest`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ κ°€μ¥ ν™•μ‹¤ν•κ³  μ¤λ¥κ°€ μ—†μµλ‹λ‹¤.

```powershell
Invoke-WebRequest -Uri http://localhost:3000/signup -Method POST -Headers @{"Content-Type"="application/json"} -Body '{"userId": "ps_user_01", "address": "0xABCDEF12345"}'
```


#### μμƒ κ²°κ³Ό

-   **μ²« μ”μ²­ (μ„±κ³µ):**
    ```
    HTTP Status Code: 201
    Response Body: νμ›κ°€μ… μ„±κ³µ
    ```

-   **λ™μΌν• `userId`λ΅ λ‹¤μ‹ μ”μ²­ (μ‹¤ν¨):**
    ```
    μ›κ²© μ„λ²„μ—μ„ (409) μ¶©λ μ¤λ¥λ¥Ό λ°ν™ν–μµλ‹λ‹¤.
    ```


-   **`userId` λλ” `address` λ„λ½ μ‹ (μ‹¤ν¨):**
    ```
    μ›κ²© μ„λ²„μ—μ„ (400) μ¶©λ μ¤λ¥λ¥Ό λ°ν™ν–μµλ‹λ‹¤
    ```

### 2. μ‚¬μ©μ λ“±λ΅ μ—¬λ¶€ ν™•μΈ (`verifyUser.js` μ¤ν¬λ¦½νΈ)

λ°μ΄ν„°λ² μ΄μ¤μ— νΉμ • `userId`κ°€ λ“±λ΅λμ–΄ μλ”μ§€ μ§μ ‘ ν™•μΈν•©λ‹λ‹¤.

```bash
node --experimental-sqlite verifyUser.js <ν™•μΈν• _userId>
```

#### μμ‹

```bash
node --experimental-sqlite verifyUser.js test_user_01
```

#### μμƒ κ²°κ³Ό

-   **μ‚¬μ©μκ°€ μ΅΄μ¬ν•  κ²½μ°:**
    ```
    μ‚¬μ©μ [test_user_01]κ°€ λ°μ΄ν„°λ² μ΄μ¤μ— μ΅΄μ¬ν•©λ‹λ‹¤. μ£Όμ†: 0x12345ABCDEF
    ```

-   **μ‚¬μ©μκ°€ μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ°:**
    ```
    μ‚¬μ©μ [non_existent_user]λ” λ°μ΄ν„°λ² μ΄μ¤μ— μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.
    ```

### 3. ν΄λ¦­ μ‹λ®¬λ μ΄μ… (`tcpClient.js` μ¤ν¬λ¦½νΈ)

TCP μ„λ²„λ¥Ό ν†µν•΄ ν΄λ¦­ μ΄λ²¤νΈλ¥Ό μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤. μ¤ν¬λ¦½νΈ μ‹¤ν–‰ μ‹ μ‚¬μ©μ IDλ¥Ό μ…λ ¥λ°›μ•„ λ“±λ΅ μ—¬λ¶€λ¥Ό ν™•μΈν• ν›„ ν΄λ¦­μ„ μ‹λ„ν•©λ‹λ‹¤.

```bash
node tcpClient.js
```

#### μ‚¬μ© λ°©λ²•

1.  μ„ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•λ©΄ `ν΄λ¦­ν•  μ‚¬μ©μ IDλ¥Ό μ…λ ¥ν•μ„Έμ”: ` ν”„λ΅¬ν”„νΈκ°€ λ‚νƒ€λ‚©λ‹λ‹¤.
2.  ν…μ¤νΈν•  `userId`λ¥Ό μ…λ ¥ν•κ³  Enterλ¥Ό λ„λ¦…λ‹λ‹¤.

#### μμƒ κ²°κ³Ό

-   **λ“±λ΅λ μ‚¬μ©μ ID μ…λ ¥ μ‹ (ν΄λ¦­ μ‹λ„):**
    ```
    μ‚¬μ©μ [μ…λ ¥ν•_userId]λ” νμ›κ°€μ…λμ–΄ μμµλ‹λ‹¤. ν΄λ¦­μ„ μ‹μ‘ν•©λ‹λ‹¤.
    μ„λ²„μ— μ—°κ²°λ¨: localhost:3001
    ν΄λ¦­ λ°μ΄ν„° μ „μ†΅: {"userId":"μ…λ ¥ν•_userId","timestamp":...}
    μ„λ²„ μ‘λ‹µ: OK
    μ„λ²„ μ—°κ²° μΆ…λ£λ¨.
    ```

-   **λ―Έλ“±λ΅ μ‚¬μ©μ ID μ…λ ¥ μ‹ (ν΄λ¦­ μ‹λ„ μ• ν•¨):**
    ```
    μ‚¬μ©μ [μ…λ ¥ν•_userId]λ” λ°μ΄ν„°λ² μ΄μ¤μ— μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤. νμ›κ°€μ…μ΄ ν•„μ”ν•©λ‹λ‹¤.
    HTTP μ„λ²„μ /signup κ²½λ΅λ¥Ό μ΄μ©ν•΄μ£Όμ„Έμ”.
    ```

-   **μ„λ²„ μ‘λ‹µμ— λ”°λ¥Έ μ¶”κ°€ λ©”μ‹μ§€:**
    *   `μ„λ²„ μ‘λ‹µ: ERROR: μ‚¬μ©μ [μ…λ ¥ν•_userId]λ” κ²μ„μ— μ°Έμ—¬ν•  μ μ—†μµλ‹λ‹¤.`
        `-> μ΄ μ‚¬μ©μλ” μ΄λ―Έ κ²μ„μ— μ°Έμ—¬ν–κ±°λ‚ μ‹¤κ²© μ²λ¦¬λμ—μµλ‹λ‹¤.`
    *   `μ„λ²„ μ‘λ‹µ: ERROR: ν΄λ¦­μ΄ μ ν¨ν•μ§€ μ•μµλ‹λ‹¤.`
        (κ²μ„ μ‹μ‘ μ „, κ²μ„ μΆ…λ£ ν›„, μ‹κ°„ λ²”μ„ λ²—μ–΄λ‚¨, μ¬λΌμ΄λ”© μλ„μ° μ΄κ³Ό λ“± `gameLogic` κ·μΉ™ μ„λ° μ‹)

---

## λ‹¤μ λ‹¨κ³„

-   **ν΄λ¬μ¤ν„° λ¨λ“ κµ¬ν„:** `server.js`λ¥Ό μμ •ν•μ—¬ `node:cluster`λ¥Ό μ‚¬μ©ν•κ³ , λ§μ¤ν„°-μ›μ»¤ κ°„μ κ²μ„ μƒνƒ λ™κΈ°ν™” λ΅μ§μ„ κµ¬ν„ν•΄μ•Ό ν•©λ‹λ‹¤.
-   **ν…μ¤νΈ μ½”λ“ μ‘μ„±:** κ³Όμ  μ”κµ¬μ‚¬ν•­μ— λ”°λΌ μ λ‹› ν…μ¤νΈ λ° E2E ν…μ¤νΈλ¥Ό μ‘μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
